<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>å¿ƒç†ã‚¼ãƒŸã¨ã¯ | åŒ—å¤§å¿ƒç†ã‚¼ãƒŸ</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+JP:wght@700;900&family=Zen+Kaku+Gothic+New:wght@700;900&family=Zen+Maru+Gothic:wght@400;700;900&display=swap" rel="stylesheet">
    <script src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>
    <style>
        body { font-family: 'Zen Maru Gothic', sans-serif; background: linear-gradient(-45deg, #ffffff, #f8fafc, #eff6ff, #fdf4ff, #fffbeb); background-size: 300% 300%; animation: auroraBG 15s ease infinite; color: #1e293b; min-height: 100vh; padding-bottom: 5rem; overflow-x: hidden; }
        @keyframes auroraBG { 0% { background-position: 0% 50%; } 50% { background-position: 100% 50%; } 100% { background-position: 0% 50%; } }
        .glass-card { background: rgba(255, 255, 255, 0.75); backdrop-filter: blur(20px); border: 1px solid rgba(255, 255, 255, 0.9); box-shadow: 0 10px 30px -10px rgba(71, 85, 105, 0.15); }
        .fade-in { animation: fadeIn 0.4s ease-out forwards; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        .no-scrollbar::-webkit-scrollbar { display: none; }
        .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
        .video-overlay { background: linear-gradient(to top, rgba(255,255,255,1) 0%, rgba(255,255,255,0.2) 60%, rgba(0,0,0,0.1) 100%); }
        
        /* çµŒé¨“å€¤ç²å¾—ãƒãƒƒãƒ—ã‚¢ãƒƒãƒ—ã®ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ */
        .exp-toast { animation: floatUp 1.5s ease-out forwards; pointer-events: none; }
        @keyframes floatUp { 0% { opacity: 0; transform: translate(-50%, 0) scale(0.8); } 20% { opacity: 1; transform: translate(-50%, -20px) scale(1.1); } 80% { opacity: 1; transform: translate(-50%, -40px) scale(1); } 100% { opacity: 0; transform: translate(-50%, -50px) scale(0.9); } }
    </style>
</head>
<body class="safe-area-inset-top">

    <!-- â–¼â–¼ ãƒ›ãƒ¼ãƒ ç”»é¢ï¼ˆãƒãƒ¼ã‚¿ãƒ«ï¼‰ â–¼â–¼ -->
    <main id="portal-view" class="relative pb-10">
        <!-- ãƒ’ãƒ¼ãƒ­ãƒ¼ã‚»ã‚¯ã‚·ãƒ§ãƒ³ -->
        <div class="relative w-full h-[40vh] overflow-hidden rounded-b-[2.5rem] shadow-sm mb-6">
            <img src="https://images.unsplash.com/photo-1523240795612-9a054b0db644?auto=format&fit=crop&q=80&w=1000" class="absolute inset-0 w-full h-full object-cover object-center" alt="">
            <div class="absolute inset-0 video-overlay"></div>
            
            <div class="absolute bottom-6 left-5 right-5 fade-in">
                <span class="bg-white/90 backdrop-blur text-indigo-600 text-[9px] font-black tracking-widest px-3 py-1 rounded-full shadow-sm">åŒ—å¤§å¿ƒç†ã‚¼ãƒŸ PORTAL</span>
                <h1 class="text-2xl font-black text-slate-800 mt-2 leading-tight tracking-tight" style="font-family: 'Zen Kaku Gothic New', sans-serif;">
                    å­¦å•ã®å®Ÿè·µã€‚<br>
                    <span class="text-transparent bg-clip-text bg-gradient-to-r from-indigo-600 to-pink-500">çŸ¥è­˜ã‚’è¡Œå‹•ã«å¤‰ãˆã‚‹å ´æ‰€</span>
                </h1>
            </div>
        </div>

        <div class="px-5 space-y-6">
            
            <!-- âœ¨ ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ï¼†ãƒ¬ãƒ™ãƒ«ã‚¦ã‚£ã‚¸ã‚§ãƒƒãƒˆ âœ¨ -->
            <section id="user-profile-widget" class="glass-card rounded-2xl p-4 flex items-center gap-4 fade-in hidden" style="animation-delay: 0.1s;">
                <img id="user-avatar" src="https://cdn-icons-png.flaticon.com/512/847/847969.png" class="w-14 h-14 rounded-full border-2 border-white shadow-sm object-cover" alt="User Icon">
                <div class="flex-1">
                    <p class="text-[10px] text-slate-500 font-bold mb-0.5">ã‚ˆã†ã“ãã€</p>
                    <p id="user-name" class="text-base font-black text-slate-800 leading-none mb-2">ã‚²ã‚¹ãƒˆ ã•ã‚“</p>
                    <div class="flex items-center gap-2">
                        <span id="user-title" class="text-[9px] font-black bg-slate-100 text-slate-600 px-2 py-0.5 rounded-full border border-slate-200 shadow-inner">èª­è¾¼ä¸­...</span>
                        <div class="flex-1 h-2 bg-slate-200 rounded-full overflow-hidden">
                            <div id="xp-bar" class="h-full bg-gradient-to-r from-indigo-500 to-pink-500 w-0 transition-all duration-700 ease-out"></div>
                        </div>
                        <span id="progress-text" class="text-[10px] text-slate-500 font-bold">0/0</span>
                    </div>
                </div>
            </section>

            <!-- âœ¨ æ¢ç´¢ãƒ¢ãƒ¼ãƒ‰èµ·å‹•ãƒœã‚¿ãƒ³ âœ¨ -->
            <section class="fade-in" style="animation-delay: 0.2s;">
                <div onclick="startExploration()" class="relative overflow-hidden bg-gradient-to-br from-indigo-500 via-purple-500 to-pink-500 rounded-2xl p-1 shadow-md cursor-pointer active:scale-95 transition-transform">
                    <div class="bg-white/10 backdrop-blur-md rounded-[1rem] p-4 flex items-center justify-between">
                        <div>
                            <h2 class="text-white font-black text-lg mb-1 tracking-wider">ğŸ—ºï¸ ã‚¼ãƒŸã‚’æ¢ç´¢ã™ã‚‹</h2>
                            <p class="text-white/90 text-[10px] font-bold">è¨˜äº‹ã‚’èª­ã‚“ã§ãƒ¬ãƒ™ãƒ«ã‚’ä¸Šã’ã‚ˆã†ï¼</p>
                        </div>
                        <div class="w-10 h-10 bg-white/20 rounded-full flex items-center justify-center text-white text-xl shadow-inner">ğŸ‘‰</div>
                    </div>
                </div>
            </section>

            <!-- ã‚®ãƒ£ãƒ©ãƒªãƒ¼ -->
            <section class="fade-in" style="animation-delay: 0.3s;">
                <h3 class="text-sm font-black text-slate-800 tracking-widest flex items-center gap-2 mb-3 px-1"><span>ğŸ“¸</span> æ´»å‹•ã‚®ãƒ£ãƒ©ãƒªãƒ¼</h3>
                <div class="flex gap-3 overflow-x-auto no-scrollbar pb-2">
                    <img src="https://images.unsplash.com/photo-1529390079861-591de354faf5?w=300&h=200&fit=crop" class="w-36 h-24 rounded-2xl object-cover shadow-sm flex-shrink-0 border border-white" alt="">
                    <img src="https://images.unsplash.com/photo-1517486808906-6ca8b3f04846?w=300&h=200&fit=crop" class="w-36 h-24 rounded-2xl object-cover shadow-sm flex-shrink-0 border border-white" alt="">
                    <img src="https://images.unsplash.com/photo-1522202176988-66273c2fd55f?w=300&h=200&fit=crop" class="w-36 h-24 rounded-2xl object-cover shadow-sm flex-shrink-0 border border-white" alt="">
                </div>
            </section>
        </div>
    </main>

    <!-- â–¼â–¼ æ¢ç´¢ãƒ¢ãƒ¼ãƒ‰ï¼ˆã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤ï¼‰ â–¼â–¼ -->
    <div id="explore-modal" class="fixed inset-0 z-50 hidden flex-col bg-slate-50/95 backdrop-blur-xl animate-[fadeIn_0.2s_ease-out]">
        
        <!-- ãƒ˜ãƒƒãƒ€ãƒ¼ï¼ˆæˆ»ã‚‹ãƒœã‚¿ãƒ³è¿½åŠ ï¼ï¼‰ -->
        <div class="flex items-center justify-between p-4 border-b border-slate-200/50 bg-white/70 backdrop-blur-md sticky top-0 z-10">
            <button id="back-btn" onclick="goBack()" class="flex items-center gap-1 text-indigo-600 font-bold text-sm px-2 py-1 active:scale-95 transition opacity-0 pointer-events-none">
                <span class="text-lg leading-none">â—</span> æˆ»ã‚‹
            </button>
            <div class="text-[10px] font-black text-slate-400 tracking-widest absolute left-1/2 transform -translate-x-1/2">Q&A EXPLORER</div>
            <button onclick="closeExploration()" class="w-8 h-8 bg-slate-100 rounded-full flex items-center justify-center text-slate-500 font-black active:scale-95 transition text-xs">âœ•</button>
        </div>

        <div class="flex-1 overflow-y-auto pb-10 px-5 pt-5 relative" id="explore-scroll-area">
            <!-- éšå±¤ã®ç¾åœ¨åœ° -->
            <div id="breadcrumb" class="flex flex-wrap items-center gap-1.5 mb-5 text-[9px] font-bold text-slate-400"></div>

            <div class="mb-6 fade-in" id="question-header">
                <span id="current-icon" class="text-4xl block mb-2 drop-shadow-sm">ğŸ¤”</span>
                <h2 id="current-question" class="text-xl font-black text-slate-800 leading-tight tracking-tight">ä½•ã«ã¤ã„ã¦çŸ¥ã‚ŠãŸã„ã§ã™ã‹ï¼Ÿ</h2>
            </div>

            <!-- é¸æŠè‚¢ã‚³ãƒ³ãƒ†ãƒŠ -->
            <div id="options-container" class="space-y-3"></div>

            <!-- ãƒšãƒ¼ã‚¸è©³ç´°ã‚³ãƒ³ãƒ†ãƒŠ -->
            <div id="page-content" class="hidden glass-card rounded-3xl p-5 fade-in">
                <h3 id="page-title" class="text-lg font-black text-slate-800 mb-3 border-b border-slate-200 pb-2"></h3>
                <div id="page-desc" class="text-sm text-slate-600 leading-relaxed font-medium mb-6 whitespace-pre-wrap"></div>
                <button id="btn-mark-read" onclick="markAsRead()" class="w-full bg-indigo-50 border border-indigo-200 text-indigo-600 font-black py-4 rounded-xl shadow-sm active:scale-95 transition flex items-center justify-center gap-2">
                    <span class="text-lg">â˜‘ï¸</span> èª­ã‚“ã ï¼ï¼ˆEXPã‚’ç²å¾—ï¼‰
                </button>
            </div>
        </div>
    </div>

    <!-- çµŒé¨“å€¤ç²å¾—ã®ã‚¨ãƒ•ã‚§ã‚¯ãƒˆç”¨ -->
    <div id="toast-container" class="fixed top-1/2 left-1/2 z-[100]"></div>

    <script>
        // ==========================================
        // ğŸ“š æ¢ç´¢ç”¨ãƒ‡ãƒ¼ã‚¿
        // ==========================================
        const exploreData = {
            id: "root", icon: "ğŸ§­", question: "å¿ƒç†ã‚¼ãƒŸã®ä½•ã«ã¤ã„ã¦çŸ¥ã‚ŠãŸã„ã§ã™ã‹ï¼Ÿ",
            children: [
                {
                    id: "lectures", label: "ğŸ§‘â€ğŸ« ãƒ¡ã‚¤ãƒ³è¬›ç¾©ã«ã¤ã„ã¦çŸ¥ã‚‹", icon: "ğŸ§ ", question: "ä»£è¡¨ã«ã‚ˆã‚‹ã€Œè¶…å®Ÿè·µçš„ã€ãªå¿ƒç†å­¦è¬›ç¾©ï¼",
                    children: [
                        { id: "lec_about", label: "ã©ã‚“ãªè¬›ç¾©ãªã®ï¼Ÿ", icon: "ğŸ«", type: "page", title: "ãŠã‚‚ã—ã‚å¿ƒç†å­¦ç ”ç©¶ã®è§£èª¬", description: "åŒ—å¤§åˆã®ã€Œæˆæ¥­ç³»ã‚¤ãƒ³ã‚«ãƒ¬ã‚µãƒ¼ã‚¯ãƒ«ã€ã¨ã—ã¦ã€3é€±ã«1å›ã€å¿ƒç†å­¦ã®â€å½¹ã«ç«‹ã¤â€ãŠã‚‚ã—ã‚ç ”ç©¶ã‚’ç´¹ä»‹ã™ã‚‹æˆæ¥­ã‚’å—ã‘ã‚‰ã‚Œã¾ã™ï¼\n\nã“ã‚Œã¾ã§700æœ¬ä»¥ä¸Šè«–æ–‡ã‚’èª­ç ´ã—ã¦ããŸä»£è¡¨ã®åŠ è—¤å…ˆç”Ÿã‹ã‚‰ã€æ˜æ—¥ã‹ã‚‰ã™ãã«å½¹ç«‹ã¤å¿ƒç†å­¦ã®ãƒ†ã‚¯ãƒ‹ãƒƒã‚¯ã‚„çŸ¥è­˜ã‚’å­¦ã³ã¾ã™ã€‚\n\nğŸ“ ä¸»ãªé–‹å‚¬å ´æ‰€ï¼š\nHello VisitsåŒ—æµ·é“å¤§å­¦ï¼ˆâ€»Zoomã§ã®ã‚ªãƒ³ãƒ©ã‚¤ãƒ³å‚åŠ ã‚‚å¯èƒ½ã§ã™ï¼ï¼‰" },
                        {
                            id: "lec_past", label: "éå»ã®è¬›ç¾©ãƒ†ãƒ¼ãƒã‚’è¦—ãè¦‹ï¼", icon: "ğŸ“–", question: "éå»ã«ã¯ã“ã‚“ãªãƒ†ãƒ¼ãƒã§è¬›ç¾©ã—ã¾ã—ãŸ",
                            children: [
                                { id: "lec_memory", label: "è¨˜æ†¶ã®ç§‘å­¦ï¼ˆå‹‰å¼·å‰ã®7ã¤ã®ãƒ†ã‚¯ï¼‰", icon: "ğŸ“", type: "page", title: "è¨˜æ†¶ã®ç§‘å­¦â‘ ", description: "ã€éå»ã®è¬›ç¾©ä¾‹ã€‘\nå¼•ãã»ã©è¦šãˆã‚Œã‚‹ã€å‹‰å¼·å‰ã€ã«ã‚„ã‚‹ã¹ã7ã¤ã®è¨˜æ†¶ãƒ†ã‚¯\n\nãƒ»å‹‰å¼·å‰ã«â—‹â—‹ã«è§¦ã‚Œã‚‹ã ã‘ã§è¨˜æ†¶åŠ›ãŒ2å€ã«ï¼ï¼Ÿ\nãƒ»90ç§’é–“â—‹â—‹ã™ã‚‹ã ã‘ã§è¨˜æ†¶ã«å®šç€ã—ã‚„ã™ããªã‚‹æ³•å‰‡\nãƒ»è¨˜æ†¶åŠ›ã‚’é«˜ã‚ã¦ãã‚Œã‚‹é­”æ³•ã®ãƒ‰ãƒªãƒ³ã‚¯ã¨ã¯ï¼Ÿ\nãƒ»ãƒªãƒ©ãƒƒã‚¯ã‚¹ã¨è¨˜æ†¶ã®ãƒ¡ã‚«ãƒ‹ã‚ºãƒ \n\n...ãªã©ã€æ€–ããªã‚‹ãã‚‰ã„è¨˜æ†¶åŠ›ãŒä¸ŠãŒã£ã¡ã‚ƒã†å®Ÿè·µçš„ãªãƒ†ã‚¯ãƒ‹ãƒƒã‚¯ã‚’å­¦ã³ã¾ã—ãŸï¼" },
                                { id: "lec_mental", label: "ãƒ¡ãƒ³ãƒ˜ãƒ©ã®å¿ƒç†å­¦", icon: "ğŸ’”", type: "page", title: "ãƒ¡ãƒ³ãƒ˜ãƒ©ã®å¿ƒç†å­¦", description: "ã€éå»ã®è¬›ç¾©ä¾‹ã€‘\næ‚²åŠ‡ã®ãƒ’ãƒ­ã‚¤ãƒ³ã‚’æ¼”ã˜ã‚‹äººãŸã¡ã€œ\n\nãªãœäººã¯ç—…ã‚“ã§ã—ã¾ã†ã®ã‹ï¼Ÿå‘¨å›²ã«ã„ã‚‹ã€Œæ§‹ã£ã¦ã¡ã‚ƒã‚“ã€ã®å¿ƒç†æ§‹é€ ã¨ã€æ­£ã—ã„æ¥ã—æ–¹ã«ã¤ã„ã¦ç§‘å­¦çš„ãªã‚¢ãƒ—ãƒ­ãƒ¼ãƒã§è§£èª¬ã—ã¾ã—ãŸã€‚" },
                                { id: "lec_no", label: "æ–­ã‚Œãªã„æ€§æ ¼ã®æ²»ã—æ–¹", icon: "ğŸ™…â€â™‚ï¸", type: "page", title: "æ–­ã‚Œãªã„æ€§æ ¼ã®æ²»ã—æ–¹", description: "ã€éå»ã®è¬›ç¾©ä¾‹ã€‘\nã¤ã„ã¤ã„é ¼ã¿äº‹ã‚’å¼•ãå—ã‘ã¦ã—ã¾ã£ã¦è‡ªåˆ†ã®é¦–ã‚’çµã‚ã¦ã—ã¾ã†äººå¿…è¦‹ï¼\n\näººé–“é–¢ä¿‚ã‚’å£Šã•ãšã«ä¸Šæ‰‹ãã€ŒNOã€ã‚’è¨€ã†ãŸã‚ã®å¿ƒç†çš„ãƒ†ã‚¯ãƒ‹ãƒƒã‚¯ã¨ãƒã‚¤ãƒ³ãƒ‰ã‚»ãƒƒãƒˆã‚’å­¦ã³ã¾ã—ãŸã€‚" }
                            ]
                        }
                    ]
                },
                {
                    id: "projects", label: "ğŸš€ é€²è¡Œä¸­ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ", icon: "ğŸ”¥", question: "ã‚¼ãƒŸç”ŸãŒä¸»ä½“ã¨ãªã£ã¦å‹•ã‹ã™PJã®æ•°ã€…ï¼",
                    children: [
                        { id: "pj_sports", label: "é‹å‹•ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ", icon: "ğŸ‘Ÿ", type: "page", title: "é‹å‹•ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆï¼ˆé‹å–¶ï¼šã¿ã‹ã¿ç­‰ï¼‰", description: "ã€Œæœ€è¿‘å¤–å‡ºã—ã¦ãªã„ãªâ€¦ã€ã¨ã„ã†æ–¹ã«æœ—å ±ï¼å¿ƒã¨ä½“ã‚’ãƒªãƒ•ãƒ¬ãƒƒã‚·ãƒ¥ã•ã›ã‚‹ãŸã‚ã®é‹å‹•ä¼ç”»ã‚’å®šæœŸçš„ã«é–‹å‚¬ã—ã¦ã„ã¾ã™ã€‚\n\nğŸƒ éå»ã®ä¼ç”»ä¾‹ï¼š\nã€é‹å‹•ä¸è¶³è§£æ¶ˆï¼å††å±±å…¬åœ’ã‚¦ã‚©ãƒ¼ã‚­ãƒ³ã‚°ä¼šã€\næ˜¥ä¼‘ã¿ãªã©ã«å¤§é€šé§…ã«é›†åˆã—ã¦ã€ã¿ã‚“ãªã§å††å±±å…¬åœ’ã‚’æ•£æ­©ã—ã¾ã—ãŸã€‚é€”ä¸­å‚åŠ ã‚‚å¤§æ­“è¿ã®ã‚†ã‚‹ã„ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§ã™ï¼" },
                        { id: "pj_mirai", label: "æœªæ¥é–‹æ‹“å€¶æ¥½éƒ¨ (è¤‡åˆPJ)", icon: "ğŸŒ", type: "page", title: "æœªæ¥é–‹æ‹“å€¶æ¥½éƒ¨", description: "åŒ—å¤§å¿ƒç†ã‚¼ãƒŸã¯ã€Œæœªæ¥é–‹æ‹“å€¶æ¥½éƒ¨ã€ã®ä¸€éƒ¨ã¨ã—ã¦ã‚‚æ´»å‹•ã—ã¦ãŠã‚Šã€å¤šå²ã«ã‚ãŸã‚‹ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãŒå‹•ã„ã¦ã„ã¾ã™ã€‚\n\nãƒ»é•·æ©‹PJ\nãƒ»ã‚·ã‚§ã‚¢ãƒã‚¦ã‚¹PJ\nãƒ»ãƒ•ãƒ¼ãƒ‰PJ\nãƒ»å›½éš›PJ\n\nå¿ƒç†å­¦ã®æ ã‚’è¶…ãˆã¦ã€è‡ªåˆ†ã®èˆˆå‘³ã®ã‚ã‚‹åˆ†é‡ã§å®Ÿè·µçš„ãªçµŒé¨“ã‚’ç©ã‚€ã“ã¨ãŒã§ãã¾ã™ï¼" },
                        { id: "pj_app", label: "ã‚¢ãƒ—ãƒªãƒ»ã‚·ã‚¹ãƒ†ãƒ é–‹ç™ºPJ", icon: "ğŸ’»", type: "page", title: "å…¬å¼ã‚·ã‚¹ãƒ†ãƒ é–‹ç™ºï¼†ã‚³ãƒ³ãƒ†ã‚¹ãƒˆæŒ‘æˆ¦", description: "æ±å¤§ä¸»å‚¬ã®ã‚¢ãƒ—ãƒªé–‹ç™ºã‚³ãƒ³ãƒ†ã‚¹ãƒˆã€Œ100programã€ã®äºˆé¸ãƒ”ãƒƒãƒã«æŒ‘æˆ¦ã™ã‚‹ãªã©ã€ITåˆ†é‡ã«ã‚‚é€²å‡ºï¼\n\nç¾åœ¨çš†ã•ã‚“ãŒä½¿ã£ã¦ã„ã‚‹ã“ã®ã€Œå…¬å¼LINEï¼ˆAIãƒœãƒƒãƒˆæ­è¼‰ï¼‰ã€ã‚„ã€ã‚¼ãƒŸã®æƒ…å ±ã‚’ä¸€å…ƒç®¡ç†ã™ã‚‹ã€ŒNotionã€ã®ã‚·ã‚¹ãƒ†ãƒ é–‹ç™ºã‚‚ã€ã‚¼ãƒŸç”Ÿä¸»ä½“ã®ãƒãƒ¼ãƒ ã§è¡Œã£ã¦ã„ã¾ã™ã€‚" },
                        { id: "pj_shinkan", label: "æ–°æ­“PVåˆ¶ä½œPJ", icon: "ğŸ¬", type: "page", title: "æ–°æ­“PVåˆ¶ä½œãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ", description: "æ¥å¹´åº¦ã®æ–°å…¥ç”Ÿã«å‘ã‘ã¦ã€å¿ƒç†ã‚¼ãƒŸã®é­…åŠ›ã‚’ä¼ãˆã‚‹ãƒ—ãƒ­ãƒ¢ãƒ¼ã‚·ãƒ§ãƒ³ãƒ“ãƒ‡ã‚ªã‚’åˆ¶ä½œã™ã‚‹ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§ã™ã€‚NotebookLMãªã©ã®æœ€æ–°AIãƒ„ãƒ¼ãƒ«ã‚‚é§†ä½¿ã—ã¦ã‚¯ãƒªã‚¨ã‚¤ãƒ†ã‚£ãƒ–ã‚’ä½œã£ã¦ã„ã¾ã™ï¼" }
                    ]
                },
                {
                    id: "clubs", label: "ğŸ•ï¸ éƒ¨æ´»ãƒ»ã‚µãƒ¼ã‚¯ãƒ«æ´»å‹•", icon: "â˜•", question: "å‹‰å¼·ã ã‘ã˜ã‚ƒãªã„ï¼éŠã³ã‚‚å…¨åŠ›ã§ï¼",
                    children: [
                        { id: "club_drive", label: "ãƒ‰ãƒ©ã‚¤éƒ¨ğŸš—", icon: "ğŸš—", type: "page", title: "ãƒ‰ãƒ©ã‚¤éƒ¨", description: "ã¿ã‚“ãªã§è»Šã«ä¹—ã£ã¦ã€åŒ—æµ·é“ãªã‚‰ã§ã¯ã®ãƒ‰ãƒ©ã‚¤ãƒ–ã‚’æº€å–«ã™ã‚‹éƒ¨æ´»ã§ã™ï¼" },
                        { id: "club_cooking", label: "æ–™ç†éƒ¨ğŸ³", icon: "ğŸ³", type: "page", title: "æ–™ç†éƒ¨", description: "ã¿ã‚“ãªã§é›†ã¾ã£ã¦æ¥½ã—ãæ–™ç†ã‚’ä½œã‚‹éƒ¨æ´»ã§ã™ã€‚" },
                        { id: "sukoyaka", label: "ã™ã“ã‚„ã‹éƒ¨ğŸ§˜", icon: "ğŸ§˜", type: "page", title: "ã™ã“ã‚„ã‹éƒ¨", description: "å¥åº·ç¬¬ä¸€ï¼ç­‹ãƒˆãƒ¬ã‚„ã‚µã‚¦ãƒŠã«ä¸€ç·’ã«è¡Œããªã©ã€å¿ƒèº«ã®å¥åº·ã‚’ä¿ã¤ãŸã‚ã®æ´»å‹•ã‚’ã—ã¦ã„ã¾ã™ã€‚" },
                        { id: "reading", label: "èª­æ›¸éƒ¨ğŸ“š", icon: "ğŸ“š", type: "page", title: "èª­æ›¸éƒ¨", description: "ãŠã™ã™ã‚ã®æœ¬ã‚’ç´¹ä»‹ã—åˆã£ãŸã‚Šã€ã¿ã‚“ãªã§åŒã˜æœ¬ã‚’èª­ã‚“ã§ãƒ‡ã‚£ã‚¹ã‚«ãƒƒã‚·ãƒ§ãƒ³ã‚’ã™ã‚‹éƒ¨æ´»ã§ã™ã€‚" },
                        { id: "radio", label: "ãƒ©ã‚¸ã‚ªéƒ¨ğŸ“»", icon: "ğŸ“»", type: "page", title: "ãƒ©ã‚¸ã‚ªéƒ¨", description: "ã‚¼ãƒŸç”ŸåŒå£«ã§ãƒ©ã‚¸ã‚ªï¼ˆãƒãƒƒãƒ‰ã‚­ãƒ£ã‚¹ãƒˆï¼‰é…ä¿¡ã‚’è¡Œã£ã¦ã„ã¾ã™ã€‚" },
                        { id: "movie", label: "æ˜ ç”»é‘‘è³éƒ¨ğŸ¿", icon: "ğŸ¿", type: "page", title: "æ˜ ç”»é‘‘è³éƒ¨", description: "æœˆã«1å›ã€ã¿ã‚“ãªã§é›†ã¾ã£ã¦æ˜ ç”»ã‚’è¦‹ã‚‹éƒ¨æ´»ã§ã™ã€‚" },
                        { id: "cafe", label: "ã‚«ãƒ•ã‚§å·¡ã‚Šéƒ¨â˜•", icon: "â˜•", type: "page", title: "ã‚«ãƒ•ã‚§å·¡ã‚Šéƒ¨", description: "æœ­å¹Œå¸‚å†…ã®ã‚ªã‚·ãƒ£ãƒ¬ãªã‚«ãƒ•ã‚§ã‚’é–‹æ‹“ã™ã‚‹éƒ¨æ´»ã§ã™ã€‚" }
                    ]
                },
                {
                    id: "events", label: "ğŸ‰ å…¨ä½“ã‚¤ãƒ™ãƒ³ãƒˆãƒ»å‹‰å¼·ä¼š", icon: "ğŸ®", question: "ã‚¼ãƒŸå…¨ä½“ã§ç››ã‚Šä¸ŠãŒã‚‹å¤§å‹ä¼ç”»ï¼",
                    children: [
                        { id: "event_hokudaisai", label: "åŒ—å¤§ç¥­å‡ºåº—ï¼ˆå¿ƒç†æˆ¦ã‚«ã‚¸ãƒï¼‰", icon: "ğŸƒ", type: "page", title: "åŒ—å¤§ç¥­ã§ã®ç†±ã„ä¼ç”»ï¼", description: "æ¯å¹´6æœˆã®åŒ—å¤§ç¥­ï¼ˆæ¥¡é™µç¥­ï¼‰ã§ã¯ã€å¿ƒç†å­¦ã®çŸ¥è­˜ã‚’æ´»ã‹ã—ãŸä½“é¨“å‹ä¼ç”»ã‚’å‡ºåº—ã—ã¦ã„ã¾ã™ã€‚\n\néå»ã«ã¯ã€å¿ƒç†æˆ¦ã‚«ã‚¸ãƒã€ã‚’é–‹å‚¬ã—ã¾ã—ãŸï¼" },
                        { id: "event_camp", label: "å¤åˆå®¿ãƒ»ã‚¯ãƒªã‚¹ãƒã‚¹ä¼š", icon: "ğŸ„", type: "page", title: "å­£ç¯€ã®å¤§å‹ã‚¤ãƒ™ãƒ³ãƒˆ", description: "æ—¥å¸¸ã‚’é›¢ã‚Œã¦å¤§è‡ªç„¶ã§è¡Œã†ã€Œå¤åˆå®¿ã€ã‚„ã€ä¸€å¹´ã®ç· ã‚ããã‚Šã«è¡Œã†ã€Œã‚¯ãƒªã‚¹ãƒã‚¹ãƒ‘ãƒ¼ãƒ†ã‚£ã€ãªã©ï¼" },
                        { id: "study_stats", label: "çµ±è¨ˆå­¦ã‚‚ãã‚‚ãä¼š", icon: "ğŸ“Š", type: "page", title: "çµ±è¨ˆå­¦ã‚‚ãã‚‚ãä¼š", description: "å¿ƒç†å­¦ç ”ç©¶ã«æ¬ ã‹ã›ãªã„çµ±è¨ˆãƒ»ãƒ‡ãƒ¼ã‚¿åˆ†æã‚’ã¿ã‚“ãªã§è‡ªç¿’ãƒ»æ•™ãˆåˆã†ä¼šã§ã™ã€‚" },
                        { id: "study_paper", label: "è«–æ–‡è¼ªèª­ä¼š", icon: "ğŸ“„", type: "page", title: "è«–æ–‡è¼ªèª­ä¼š", description: "èˆˆå‘³ã®ã‚ã‚‹å¿ƒç†å­¦ã®è«–æ–‡ã‚’æŒã¡å¯„ã‚Šã€è¦ç´„ã‚’ç™ºè¡¨ã—åˆã†ä¼šã§ã™ã€‚" }
                    ]
                },
                {
                    id: "about_seminar", label: "ğŸ« å¿ƒç†ã‚¼ãƒŸã®æ ¹æœ¬ã«ã¤ã„ã¦", icon: "ğŸ’¡", question: "ãƒ“ã‚¸ãƒ§ãƒ³ã‚„ä»£è¡¨ã®æƒ³ã„ã‚’çŸ¥ã‚‹",
                    children: [
                        { id: "about_vision", label: "ãƒ“ã‚¸ãƒ§ãƒ³ã€å­¦å•ã®å®Ÿè·µã€", icon: "ğŸ¯", type: "page", title: "ã€Œå­¦å•ã®å®Ÿè·µã€", description: "å¿ƒç†ã‚¼ãƒŸã¯ã€Œå­¦å•ã®å®Ÿè·µã€ã‚’ãƒ†ãƒ¼ãƒã«ã€å¤§å­¦ã§å­¦ã‚“ã çŸ¥è­˜ã‚’ãŸã ã®çŸ¥è­˜ã§çµ‚ã‚ã‚‰ã›ãšã€å®Ÿéš›ã®è¡Œå‹•ã‚„ç¤¾ä¼šã«é‚„å…ƒã™ã‚‹ãŸã‚ã®ã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£ï¼ˆã‚¤ãƒ³ã‚«ãƒ¬ã‚µãƒ¼ã‚¯ãƒ«ï¼‰ã§ã™ã€‚" },
                        { id: "about_rep", label: "ä»£è¡¨ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸", icon: "ğŸ‘‘", type: "page", title: "ä»£è¡¨ã‹ã‚‰ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸", description: "åŒ—å¤§å¿ƒç†ã‚¼ãƒŸä»£è¡¨ã®åŠ è—¤ç¿”å¤§ã§ã™ã€‚\nã€Œå¿ƒç†å­¦ã‚’æœºä¸Šã®ç©ºè«–ã§çµ‚ã‚ã‚‰ã›ãŸããªã„ã€ã€Œä½•ã‹é¢ç™½ã„ã“ã¨ã‚’ä»•æ›ã‘ãŸã„ã€ãã‚“ãªç†±ã„æ€ã„ã‚’æŒã£ãŸãƒ¡ãƒ³ãƒãƒ¼ãŒé›†ã¾ã‚‹å ´æ‰€ã‚’ä½œã‚ŠãŸã„ã¨æ€ã„ã€ã“ã®çµ„ç¹”ã‚’é‹å–¶ã—ã¦ã„ã¾ã™ã€‚" },
                        { id: "about_members", label: "ã©ã‚“ãªäººãŒå‚åŠ ã§ãã‚‹ã®ï¼Ÿ", icon: "ğŸ‘¥", type: "page", title: "å¯¾è±¡è€…ã¯ã€Œé«˜æ ¡ç”Ÿä»¥ä¸Šã€å…¨å“¡ï¼", description: "ã€ŒåŒ—å¤§ã€ã¨åå‰ãŒã¤ã„ã¦ã„ã¾ã™ãŒã€å®Ÿã¯ä»–å¤§å­¦ã®å­¦ç”Ÿã€é«˜æ ¡ç”Ÿã€å¤§å­¦é™¢ç”Ÿã€ç¤¾ä¼šäººã¾ã§å¹…åºƒã„å±¤ãŒå‚åŠ ã—ã¦ã„ã‚‹ã‚ªãƒ¼ãƒ—ãƒ³ãªã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£ã§ã™ã€‚" }
                    ]
                },
                {
                    id: "faq_and_join", label: "â“ ã‚ˆãã‚ã‚‹è³ªå• / å‚åŠ æ–¹æ³•", icon: "ğŸšª", question: "ä¸å®‰ã‚’è§£æ¶ˆã—ã¦ã€ã‚¼ãƒŸã«é£›ã³è¾¼ã‚‚ã†ï¼",
                    children: [
                        { id: "faq_busy", label: "Q. å¿™ã—ãã¦ã‚‚å¤§ä¸ˆå¤«ï¼Ÿ", icon: "â±ï¸", type: "page", title: "Q. å¿™ã—ãã¦ã‚‚æ´»å‹•ã§ãã¾ã™ã‹ï¼Ÿ", description: "A. ã‚‚ã¡ã‚ã‚“ã§ã™ï¼\næ´»å‹•ã¯å¼·åˆ¶ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚è‡ªåˆ†ã®ãƒšãƒ¼ã‚¹ã§å‚åŠ ã§ãã‚‹éƒ¨æ´»ã‚„å˜ç™ºã‚¤ãƒ™ãƒ³ãƒˆã ã‘ã§ã‚‚å¤§æ­“è¿ã§ã™ã€‚" },
                        { id: "faq_knowledge", label: "Q. å¿ƒç†å­¦ã®çŸ¥è­˜ã¯å¿…è¦ï¼Ÿ", icon: "ğŸ§ ", type: "page", title: "Q. å°‚é–€çŸ¥è­˜ãŒãªãã¦ã‚‚å¹³æ°—ã§ã™ã‹ï¼Ÿ", description: "A. å…¨ãå•é¡Œã‚ã‚Šã¾ã›ã‚“ï¼\nã€Œèˆˆå‘³ãŒã‚ã‚‹ã€ã¨ã„ã†æ°—æŒã¡ãŒã‚ã‚Œã°ååˆ†ã§ã™ã€‚" },
                        { id: "join_flow", label: "ã‚¼ãƒŸã«å…¥ã‚‹ã¾ã§ã®æµã‚Œ", icon: "ğŸ¾", type: "page", title: "ã‚¼ãƒŸã«å…¥ã‚‹ã«ã¯ï¼Ÿ", description: "1. ã¾ãšã¯ã€Œè¦‹å­¦ãƒ»èª¬æ˜ä¼šï¼ˆæ–°æ­“ï¼‰ã€ã«å‚åŠ ï¼\n2. ãƒ¡ãƒ³ãƒãƒ¼ã¨ã‚«ã‚¸ãƒ¥ã‚¢ãƒ«é¢è«‡\n3. æ­£å¼ã‚¸ãƒ§ã‚¤ãƒ³ï¼ğŸ‰" }
                    ]
                }
            ]
        };

        // ==========================================
        // ğŸ® ã‚·ã‚¹ãƒ†ãƒ ãƒ­ã‚¸ãƒƒã‚¯ï¼ˆãƒ¬ãƒ™ãƒ«ãƒ»æ—¢èª­åˆ¤å®šãªã©ï¼‰
        // ==========================================
        let allPageIds = []; // ã™ã¹ã¦ã®èª­ã¿ç‰©ãƒšãƒ¼ã‚¸IDãƒªã‚¹ãƒˆ

        // ãƒ„ãƒªãƒ¼ã‚’å·¡å›ã—ã¦ã™ã¹ã¦ã®ãƒšãƒ¼ã‚¸IDã‚’å–å¾—ã™ã‚‹é–¢æ•°
        function extractAllPages(node) {
            if (node.type === "page") {
                allPageIds.push(node.id);
            } else if (node.children) {
                node.children.forEach(child => extractAllPages(child));
            }
        }
        extractAllPages(exploreData);
        const MAX_EXP = allPageIds.length; // ç·ãƒšãƒ¼ã‚¸æ•° = æœ€å¤§ãƒ¬ãƒ™ãƒ«

        // ãƒ•ã‚©ãƒ«ãƒ€å†…ã®é€²æ—ã‚’è¨ˆç®—ã™ã‚‹é–¢æ•°
        function getFolderProgress(node) {
            if (node.type === "page") {
                return localStorage.getItem('zemi_read_' + node.id) === 'true' ? { read: 1, total: 1 } : { read: 0, total: 1 };
            }
            let res = { read: 0, total: 0 };
            if (node.children) {
                node.children.forEach(child => {
                    let childProg = getFolderProgress(child);
                    res.read += childProg.read;
                    res.total += childProg.total;
                });
            }
            return res;
        }

        // ãƒ›ãƒ¼ãƒ ç”»é¢ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ¬ãƒ™ãƒ«ãƒ»ãƒ—ãƒ­ã‚°ãƒ¬ã‚¹ãƒãƒ¼ã‚’æ›´æ–°
        function updatePlayerStatus() {
            const readPages = allPageIds.filter(id => localStorage.getItem('zemi_read_' + id) === 'true');
            const currentExp = readPages.length;
            
            // UIã®æ›´æ–°
            document.getElementById('progress-text').innerText = `${currentExp}/${MAX_EXP} å®Œäº†`;
            const percent = (currentExp / MAX_EXP) * 100;
            document.getElementById('xp-bar').style.width = `${percent}%`;

            // ç§°å·ï¼ˆãƒ¬ãƒ™ãƒ«ï¼‰ã®åˆ¤å®š
            let titleText = "ã‚¼ãƒŸè¦‹å­¦è€… (Lv.1)";
            let titleClass = "bg-slate-100 text-slate-600 border-slate-200";
            
            if (currentExp >= MAX_EXP) {
                titleText = "å¿ƒç†ã‚¼ãƒŸã®ä¸» (Lv.MAX)";
                titleClass = "bg-yellow-100 text-yellow-700 border-yellow-300 shadow-md";
            } else if (currentExp >= 15) {
                titleText = "å¿ƒç†ã‚¼ãƒŸãƒã‚¹ã‚¿ãƒ¼ (Lv.4)";
                titleClass = "bg-pink-100 text-pink-600 border-pink-200";
            } else if (currentExp >= 8) {
                titleText = "ä¸€äººå‰ã‚¼ãƒŸç”Ÿ (Lv.3)";
                titleClass = "bg-purple-100 text-purple-600 border-purple-200";
            } else if (currentExp >= 3) {
                titleText = "è¦‹ç¿’ã„ã‚¼ãƒŸç”Ÿ (Lv.2)";
                titleClass = "bg-indigo-100 text-indigo-600 border-indigo-200";
            }

            const titleEl = document.getElementById('user-title');
            titleEl.innerText = titleText;
            titleEl.className = `text-[9px] font-black px-2 py-0.5 rounded-full border shadow-inner ${titleClass}`;
        }

        // ==========================================
        // ğŸ—ºï¸ æ¢ç´¢UIåˆ¶å¾¡
        // ==========================================
        let historyStack = [];
        let currentNode = exploreData;

        function startExploration() {
            document.getElementById('explore-modal').classList.remove('hidden');
            document.getElementById('explore-modal').classList.add('flex');
            historyStack = [exploreData];
            renderNode(exploreData);
        }

        function closeExploration() {
            document.getElementById('explore-modal').classList.add('hidden');
            document.getElementById('explore-modal').classList.remove('flex');
            updatePlayerStatus(); // é–‰ã˜ãŸæ™‚ã«ãƒ›ãƒ¼ãƒ ç”»é¢ã®ã‚²ãƒ¼ã‚¸ã‚’æ›´æ–°
        }

        function renderNode(node) {
            currentNode = node;
            
            // æˆ»ã‚‹ãƒœã‚¿ãƒ³ã®è¡¨ç¤ºåˆ¶å¾¡
            const backBtn = document.getElementById('back-btn');
            if (historyStack.length > 1) {
                backBtn.classList.remove('opacity-0', 'pointer-events-none');
            } else {
                backBtn.classList.add('opacity-0', 'pointer-events-none');
            }

            // ãƒ‘ãƒ³ããšãƒªã‚¹ãƒˆ
            let breadcrumbHtml = `<span onclick="goBackTo(0)" class="cursor-pointer text-indigo-500">ğŸ  ãƒˆãƒƒãƒ—</span>`;
            for (let i = 1; i < historyStack.length; i++) {
                let shortLabel = historyStack[i].label.split(' ')[1] || historyStack[i].label;
                breadcrumbHtml += `<span class="text-slate-300 mx-1">/</span><span onclick="goBackTo(${i})" class="cursor-pointer text-indigo-500 truncate max-w-[80px]">${shortLabel}</span>`;
            }
            document.getElementById('breadcrumb').innerHTML = breadcrumbHtml;

            // è³ªå•ã®æ›´æ–°
            document.getElementById('current-icon').innerText = node.icon || "âœ¨";
            document.getElementById('current-question').innerText = node.question || "è©³ç´°ã‚’è¦‹ã‚‹";

            // ä¸€ç•ªä¸Šã¾ã§ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«
            document.getElementById('explore-scroll-area').scrollTop = 0;

            if (node.type === "page") {
                // ãƒšãƒ¼ã‚¸è¡¨ç¤ºãƒ¢ãƒ¼ãƒ‰
                document.getElementById('options-container').classList.add('hidden');
                document.getElementById('page-content').classList.remove('hidden');
                
                document.getElementById('page-title').innerText = node.title || node.label;
                document.getElementById('page-desc').innerText = node.description;
                
                const isRead = localStorage.getItem('zemi_read_' + node.id) === 'true';
                const btn = document.getElementById('btn-mark-read');
                if (isRead) {
                    btn.innerHTML = `<span class="text-lg">âœ…</span> æ—¢èª­æ¸ˆã¿ï¼ˆæˆ»ã‚‹ï¼‰`;
                    btn.className = "w-full bg-emerald-50 border border-emerald-200 text-emerald-600 font-black py-4 rounded-xl shadow-sm active:scale-95 transition flex items-center justify-center gap-2 mt-4";
                } else {
                    btn.innerHTML = `<span class="text-lg">â˜‘ï¸</span> èª­ã‚“ã ï¼ï¼ˆEXPã‚’ç²å¾—ï¼‰`;
                    btn.className = "w-full bg-gradient-to-r from-indigo-500 to-pink-500 text-white font-black py-4 rounded-xl shadow-md active:scale-95 transition flex items-center justify-center gap-2 mt-4";
                }
            } else {
                // é¸æŠè‚¢è¡¨ç¤ºãƒ¢ãƒ¼ãƒ‰
                document.getElementById('page-content').classList.add('hidden');
                document.getElementById('options-container').classList.remove('hidden');
                
                let optionsHtml = "";
                if (node.children) {
                    node.children.forEach(child => {
                        let statusIcon = "ğŸ‘‰";
                        let borderClass = "border-slate-200";
                        let bgClass = "bg-white";
                        let textClass = "text-slate-700";
                        
                        // é€²æ—ç‡ã®è¨ˆç®—
                        const prog = getFolderProgress(child);
                        const isCompleted = prog.total > 0 && prog.read === prog.total;
                        
                        let progressTextHtml = "";
                        if (child.type !== "page") {
                            progressTextHtml = `<span class="text-[9px] font-bold text-slate-400 ml-2">(${prog.read}/${prog.total})</span>`;
                        }

                        if (isCompleted) {
                            statusIcon = "âœ…";
                            borderClass = "border-emerald-200";
                            bgClass = "bg-emerald-50/50";
                            textClass = "text-slate-500";
                        }

                        optionsHtml += `
                            <button onclick="selectOption('${child.id}')" class="w-full ${bgClass} ${borderClass} border rounded-2xl p-4 flex items-center justify-between shadow-sm hover:shadow-md active:scale-95 transition-all text-left">
                                <div class="flex items-center gap-3 flex-1 overflow-hidden">
                                    <span class="text-2xl flex-shrink-0">${child.icon || "âœ¨"}</span>
                                    <div class="truncate">
                                        <span class="font-black ${textClass} text-sm">${child.label}</span>
                                        ${progressTextHtml}
                                    </div>
                                </div>
                                <span class="text-sm ml-2 flex-shrink-0">${statusIcon}</span>
                            </button>
                        `;
                    });
                }
                document.getElementById('options-container').innerHTML = optionsHtml;
            }
        }

        function selectOption(childId) {
            const childNode = currentNode.children.find(c => c.id === childId);
            if (childNode) {
                historyStack.push(childNode);
                renderNode(childNode);
            }
        }

        function goBack() {
            if (historyStack.length > 1) {
                historyStack.pop();
                renderNode(historyStack[historyStack.length - 1]);
            }
        }

        function goBackTo(index) {
            historyStack = historyStack.slice(0, index + 1);
            renderNode(historyStack[historyStack.length - 1]);
        }

        // çµŒé¨“å€¤ç²å¾—ã®ã‚¨ãƒ•ã‚§ã‚¯ãƒˆ
        function showExpToast() {
            const toast = document.createElement('div');
            toast.className = 'exp-toast text-pink-500 font-black text-xl drop-shadow-md';
            toast.innerText = 'âœ¨ +1 EXP';
            document.getElementById('toast-container').appendChild(toast);
            setTimeout(() => toast.remove(), 1500);
        }

        function markAsRead() {
            const wasRead = localStorage.getItem('zemi_read_' + currentNode.id) === 'true';
            
            if (!wasRead) {
                localStorage.setItem('zemi_read_' + currentNode.id, 'true');
                showExpToast();
                // å°‘ã—é…å»¶ã•ã›ã¦ã‹ã‚‰æˆ»ã‚‹ï¼ˆã‚¨ãƒ•ã‚§ã‚¯ãƒˆã‚’è¦‹ã›ã‚‹ãŸã‚ï¼‰
                setTimeout(() => {
                    goBack();
                }, 600);
            } else {
                goBack();
            }
        }

        // ==========================================
        // ğŸš€ LIFFåˆæœŸåŒ–ï¼†é–‹å§‹
        // ==========================================
        async function initIntro() {
            updatePlayerStatus(); // åˆæœŸæç”»
            document.getElementById('user-profile-widget').classList.remove('hidden');

            try {
                await liff.init({ liffId: "2009176797-wHDy2QrV" }); 
                if (liff.isLoggedIn()) {
                    const profile = await liff.getProfile();
                    document.getElementById('user-name').innerText = profile.displayName + " ã•ã‚“";
                    document.getElementById('user-avatar').src = profile.pictureUrl || "https://cdn-icons-png.flaticon.com/512/847/847969.png";
                } else {
                    liff.login();
                }
            } catch (err) {
                console.error("LIFF Init Error:", err);
            }
        }
        
        initIntro();
    </script>
</body>
</html>